<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MaizeGuard AI â€” Maize Disease Classifier | OUK MSc AI</title>
  <meta name="description"
    content="AI-powered maize leaf disease detection using ResNet50 deep learning. MSc AI Project, Open University of Kenya." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>

<body>

  <div class="bg-grid"></div>
  <div class="bg-glow bg-glow-1"></div>
  <div class="bg-glow bg-glow-2"></div>

  <!-- â”€â”€ Header â”€â”€ -->
  <header class="header">
    <div class="container">
      <div class="logo">
        <span class="logo-icon">ğŸŒ½</span>
        <div>
          <span class="logo-title">MaizeGuard <span class="logo-ai">AI</span></span>
          <span class="logo-sub">Disease Detection System</span>
        </div>
      </div>
      <nav class="nav">
        <button class="theme-toggle" id="themeToggle" title="Toggle light/dark mode">
          <span class="toggle-icon">ğŸŒ™</span>
          <span class="toggle-label">Dark</span>
        </button>
        <span class="badge {% if model_ready %}badge-live{% else %}badge-demo{% endif %}">
          {% if model_ready %}â— LIVE MODEL{% else %}â— DEMO MODE{% endif %}
        </span>
      </nav>
    </div>
  </header>

  <!-- â”€â”€ Hero â”€â”€ -->
  <section class="hero">
    <div class="container">
      <div class="hero-content">
        <div class="hero-badge">MSc AI Research â€” Open University of Kenya</div>
        <h1 class="hero-title">
          Detect Maize Diseases<br />
          <span class="gradient-text">Instantly with AI</span>
        </h1>
        <p class="hero-desc">
          Upload a photo of your maize leaf. Our ResNet50 model with Test-Time Augmentation
          classifies it in seconds â€” then generate a full agronomic report with treatment
          recommendations and prevention strategies.
        </p>
        <div class="hero-stats">
          <div class="stat-pill"><span class="stat-num">3</span><span class="stat-lbl">Disease Classes</span></div>
          <div class="stat-pill"><span class="stat-num">TTA Ã—6</span><span class="stat-lbl">Accuracy Boost</span></div>
          <div class="stat-pill"><span class="stat-num">ResNet50</span><span class="stat-lbl">Architecture</span></div>
          <div class="stat-pill"><span class="stat-num">Grad-CAM</span><span class="stat-lbl">XAI Heatmap</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- â”€â”€ Main â”€â”€ -->
  <main class="main">
    <div class="container">
      <div class="classifier-grid">

        <!-- Upload Panel -->
        <div class="panel upload-panel">
          <div class="panel-header">
            <span class="panel-icon">ğŸ“·</span>
            <h2>Upload Leaf Image</h2>
          </div>

          <div class="upload-zone" id="uploadZone">
            <input type="file" id="fileInput" accept=".jpg,.jpeg,.png,.webp" hidden />
            <div class="upload-idle" id="uploadIdle">
              <div class="upload-icon-wrap">
                <svg class="upload-svg" viewBox="0 0 48 48" fill="none">
                  <circle cx="24" cy="24" r="23" stroke="currentColor" stroke-width="1.5" stroke-dasharray="4 3" />
                  <path d="M24 32V16M16 24l8-8 8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                </svg>
              </div>
              <p class="upload-title">Drop your image here</p>
              <p class="upload-sub">or <button class="link-btn"
                  onclick="document.getElementById('fileInput').click()">browse files</button></p>
              <p class="upload-hint">JPG Â· PNG Â· WEBP Â· up to 16 MB</p>
            </div>
            <div class="upload-preview" id="uploadPreview" style="display:none">
              <img id="previewImg" alt="Uploaded leaf" />
              <button class="clear-btn" id="clearBtn" title="Remove">âœ•</button>
            </div>
          </div>

          <button class="analyze-btn" id="analyzeBtn" disabled>
            <span class="btn-text">ğŸ” Analyse Leaf</span>
            <span class="btn-spinner" id="btnSpinner" style="display:none">
              <svg viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" opacity=".25" />
                <path d="M12 2a10 10 0 0110 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </span>
          </button>

          <div class="tips-box">
            <h4>ğŸ“‹ Tips for best results</h4>
            <ul>
              <li>Close-up of a single leaf â€” fill the frame</li>
              <li>Good natural lighting, no camera flash</li>
              <li>Hold the leaf flat and steady</li>
              <li>Avoid blurry or night photos</li>
            </ul>
          </div>
        </div>

        <!-- Results Panel -->
        <div class="panel results-panel" id="resultsPanel">

          <div class="empty-state" id="emptyState">
            <div class="empty-icon">ğŸ”¬</div>
            <h3>Ready to analyse</h3>
            <p>Upload a maize leaf image on the left to see the AI prediction with Grad-CAM heatmap and detailed
              recommendations.</p>
          </div>

          <div class="loading-state" id="loadingState" style="display:none">
            <div class="loader-ring"></div>
            <p>Analysing your leafâ€¦</p>
            <span>Running ResNet50 + TTA (Ã—6 augmentations)</span>
          </div>

          <div class="result-content" id="resultContent" style="display:none">

            <div class="result-header" id="resultHeader">
              <span class="result-icon" id="resultIcon"></span>
              <div class="result-header-text">
                <h2 class="result-label" id="resultLabel"></h2>
                <p class="result-conf" id="resultConf"></p>
                <span class="severity-badge" id="severityBadge"></span>
              </div>
            </div>

            <!-- Uncertainty warning -->
            <div class="uncertainty-box" id="uncertaintyBox" style="display:none">
              ğŸ¤” <strong>Low confidence:</strong> The model is uncertain about this image.
              Try a clearer, better-lit photo for a more reliable result.
            </div>

            <div class="advice-box" id="adviceBox">
              <span class="advice-icon">ğŸ’¡</span>
              <p id="adviceText"></p>
            </div>

            <!-- Probability bars -->
            <div class="prob-section">
              <h4>Class Probabilities <span class="tta-badge">TTA Ã—6</span></h4>
              <div id="probBars"></div>
            </div>

            <!-- Grad-CAM -->
            <div class="gradcam-section" id="gradcamSection" style="display:none">
              <h4>ğŸ” Grad-CAM Explanation <span class="xai-badge">XAI</span></h4>
              <p class="gradcam-desc">Highlighted regions show where the AI focused its attention to make this
                prediction</p>
              <div class="gradcam-wrap">
                <div class="gradcam-img-box">
                  <img id="gradcamImg" alt="Grad-CAM heatmap" />
                  <span class="img-label">Attention Heatmap</span>
                </div>
              </div>
            </div>

            <!-- Full report button -->
            <button class="report-btn" id="reportBtn">
              ğŸ“„ Generate Full Agronomic Report
            </button>

            <div class="demo-notice" id="demoNotice" style="display:none">
              âš ï¸ <strong>Demo Mode:</strong> Predictions are illustrative. Train the model with 50+ images per class for
              real results.
            </div>
          </div>
        </div>

      </div><!-- /.classifier-grid -->

      <!-- Info panels -->
      <div class="info-grid">
        <div class="panel info-panel">
          <div class="panel-header"><span class="panel-icon">ğŸ“Š</span>
            <h3>Dataset Status</h3>
          </div>
          <p class="info-sub">Images in <code>data/raw/</code></p>
          <div class="class-bars">
            {% set total = stats.healthy + stats.streak + stats.mln %}
            <div class="class-row">
              <div class="class-meta"><span class="dot dot-green"></span><span>Healthy</span></div>
              <div class="class-bar-wrap">
                <div class="class-bar" style="width:{{ [stats.healthy / 50 * 100, 100] | min }}%; background:#22c55e">
                </div>
              </div>
              <span class="class-count">{{ stats.healthy }}/50</span>
            </div>
            <div class="class-row">
              <div class="class-meta"><span class="dot dot-amber"></span><span>Streak</span></div>
              <div class="class-bar-wrap">
                <div class="class-bar" style="width:{{ [stats.streak / 50 * 100, 100] | min }}%; background:#f59e0b">
                </div>
              </div>
              <span class="class-count">{{ stats.streak }}/50</span>
            </div>
            <div class="class-row">
              <div class="class-meta"><span class="dot dot-red"></span><span>MLN</span></div>
              <div class="class-bar-wrap">
                <div class="class-bar" style="width:{{ [stats.mln / 50 * 100, 100] | min }}%; background:#ef4444"></div>
              </div>
              <span class="class-count">{{ stats.mln }}/50</span>
            </div>
          </div>
          <p class="total-label">Total: <strong>{{ total }}</strong> &nbsp;Â·&nbsp; Target: <strong>150+</strong></p>
        </div>

        <div class="panel info-panel">
          <div class="panel-header"><span class="panel-icon">ğŸ—ï¸</span>
            <h3>Model Architecture</h3>
          </div>
          <div class="arch-list">
            <div class="arch-item"><span class="arch-key">Backbone</span><span class="arch-val">ResNet50
                (ImageNet)</span></div>
            <div class="arch-item"><span class="arch-key">Attention</span><span class="arch-val">SE-Attention
                Block</span></div>
            <div class="arch-item"><span class="arch-key">Accuracy</span><span class="arch-val">TTA Ã— 6
                augmentations</span></div>
            <div class="arch-item"><span class="arch-key">Optimizer</span><span class="arch-val">Adam (LR =
                0.001)</span></div>
            <div class="arch-item"><span class="arch-key">Loss</span><span class="arch-val">Categorical
                Cross-Entropy</span></div>
            <div class="arch-item"><span class="arch-key">XAI</span><span class="arch-val">Grad-CAM + LIME</span></div>
          </div>
        </div>

        <div class="panel info-panel">
          <div class="panel-header"><span class="panel-icon">ğŸ“š</span>
            <h3>Disease Classes</h3>
          </div>
          <div class="disease-list">
            <div class="disease-item"><span class="disease-dot" style="background:#22c55e"></span>
              <div><strong>Healthy</strong>
                <p>Uniform dark green, no lesions</p>
              </div>
            </div>
            <div class="disease-item"><span class="disease-dot" style="background:#f59e0b"></span>
              <div><strong>Maize Streak Virus (MSV)</strong>
                <p>Yellow-white streaks parallel to leaf veins; spread by leafhoppers</p>
              </div>
            </div>
            <div class="disease-item"><span class="disease-dot" style="background:#ef4444"></span>
              <div><strong>Maize Lethal Necrosis (MLN)</strong>
                <p>Chlorotic mottling then total plant death; causes 100% crop loss</p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FULL REPORT MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="modalOverlay" style="display:none">
    <div class="modal" id="reportModal">
      <button class="modal-close" id="modalClose">âœ•</button>

      <div class="modal-loading" id="modalLoading">
        <div class="loader-ring"></div>
        <p>Generating full reportâ€¦</p>
      </div>

      <div class="modal-content" id="modalContent" style="display:none">

        <!-- Report header -->
        <div class="report-header" id="reportHeaderBlock">
          <div class="report-logo">ğŸŒ½ MaizeGuard AI &nbsp;â€”&nbsp; Agronomic Disease Report</div>
          <div class="report-meta" id="reportMeta"></div>
        </div>

        <!-- Diagnosis summary -->
        <div class="report-section diagnosis-block" id="diagnosisBlock">
          <h2 id="rLabel"></h2>
          <div class="diagnosis-row">
            <div class="diag-card"><span class="diag-key">Confidence</span><span class="diag-val" id="rConf"></span>
            </div>
            <div class="diag-card"><span class="diag-key">Severity</span><span class="diag-val" id="rSeverity"></span>
            </div>
            <div class="diag-card"><span class="diag-key">Report ID</span><span class="diag-val" id="rId"
                style="font-size:12px"></span></div>
            <div class="diag-card"><span class="diag-key">Generated</span><span class="diag-val" id="rTime"
                style="font-size:12px"></span></div>
          </div>
        </div>

        <!-- Uncertainty notice -->
        <div class="report-uncertainty" id="rUncertainty" style="display:none">
          âš ï¸ <strong>Caution:</strong> Model confidence is below 55%. Image quality or ambiguous symptoms may affect
          accuracy. Consider professional agronomic assessment.
        </div>

        <!-- Sections -->
        <div class="report-section">
          <h3>ğŸ”­ Disease Overview</h3>
          <p id="rOverview"></p>
        </div>

        <div class="report-section">
          <h3>ğŸ‘ï¸ Visual Symptoms Detected</h3>
          <ul class="report-list" id="rSymptoms"></ul>
        </div>

        <div class="report-section two-col-grid">
          <div>
            <h3>ğŸ§¬ What Is It?</h3>
            <p id="rWhatIs"></p>
          </div>
          <div>
            <h3>ğŸŒ¬ï¸ How Does It Spread?</h3>
            <p id="rSpread"></p>
          </div>
        </div>

        <div class="report-section">
          <h3>ğŸ’° Economic Impact</h3>
          <p id="rEcon"></p>
        </div>

        <!-- Differential diagnosis -->
        <div class="report-section">
          <h3>ğŸ”„ Differential Diagnosis</h3>
          <p class="report-sub">Other possible conditions considered by the model:</p>
          <div id="rDifferential"></div>
        </div>

        <!-- Grad-CAM -->
        <div class="report-section" id="rGradcamSection" style="display:none">
          <h3>ğŸ” Grad-CAM Explainability Map</h3>
          <p class="report-sub">The highlighted (warm) areas show where the AI focused to identify the disease</p>
          <img id="rGradcam" alt="Grad-CAM" class="report-gradcam" />
        </div>

        <!-- Action plan -->
        <div class="report-section action-section">
          <h3>ğŸš¨ Immediate Actions <span class="priority-badge">Do Now</span></h3>
          <ul class="report-list action-list urgent" id="rImmediate"></ul>
        </div>

        <div class="report-section action-section">
          <h3>ğŸ“… Short-Term Actions <span class="priority-badge medium">This Season</span></h3>
          <ul class="report-list action-list" id="rShortTerm"></ul>
        </div>

        <div class="report-section action-section">
          <h3>ğŸ›¡ï¸ Long-Term Prevention <span class="priority-badge low">Next Seasons</span></h3>
          <ul class="report-list action-list" id="rLongTerm"></ul>
        </div>

        <div class="report-section">
          <h3>ğŸ’Š Treatment Options</h3>
          <ul class="report-list treatment-list" id="rTreatment"></ul>
        </div>

        <!-- References -->
        <div class="report-section">
          <h3>ğŸ“– References</h3>
          <ol class="report-list ref-list" id="rRefs"></ol>
        </div>

        <!-- Print / Close -->
        <div class="report-footer">
          <button class="print-btn" onclick="window.print()">ğŸ–¨ï¸ Print Report</button>
          <button class="close-report-btn" id="closeReportBtn">Close</button>
        </div>

      </div><!-- /.modal-content -->
    </div>
  </div>

  <!-- â”€â”€ Footer â”€â”€ -->
  <footer class="footer">
    <div class="container">
      <p><strong>MaizeGuard AI</strong> &nbsp;Â·&nbsp; MSc Artificial Intelligence â€” Open University of Kenya (OUK)
        &nbsp;Â·&nbsp; WANDABWA Frieze (ST62/55175/2025) &nbsp;Â·&nbsp; Supervisor: Dr. Richard Rimiru</p>
      <p class="footer-sub">ResNet50 + TTA + Grad-CAM &nbsp;Â·&nbsp; TensorFlow 2.20 &nbsp;Â·&nbsp; FRIENDS Framework
        Compliant</p>
    </div>
  </footer>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>